<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hospital SignUp</title>
</head>
<body>
    <center><h1>Hospital SignUp Page</h1></center>
    <label for="hospital-name">Hospital Name: </label>
    <input type="text" id="hospital-name" /><br>
    <label for="hospital-email">Hospital Email: </label>
    <input type="text" id="hospital-email" required /><br>
    <label for="hospital-location">Location: </label>
    <input type="text" id="hospital-location" placeholder="Enter the city name" /><br>
    <label for="hospital-latitude">Latitude: </label>
    <input type="text" id="hospital-latitude" readonly /><br>
    <label for="hospital-longitude">Longitude: </label>
    <input type="text" id="hospital-longitude" readonly /><br>
    <label for="hospital-total-floors">Number of Floors for accomodating patients: </label>
    <input type="text" id="hospital-total-floors" /><br>
    <label for="hospital-floor-rooms">Number of Rooms in each floor: </label>
    <input type="text" id="hospital-floor-rooms" /><br>
    <label for="hospital-total-rooms">Total Number of Rooms: </label>
    <input type="text" id="hospital-total-rooms" /><br>

    <button onclick="getAndSetLocation()">Get Exact Location(Do not use VPN)</button><br>
    <button onclick="validate()">Submit</button>

    <script>
        function d(x) {
            return document.getElementById(x);
        }

        // Get the exact Latitude and Longitude
        function getAndSetLocation() {
            // console.log("working");
            if(navigator.geolocation){
                navigator.geolocation.getCurrentPosition(setPosition);
            } else {
                alert("Cannot get exact location");
            }
        }

        // Set Latitude and Longitude in the form
        function setPosition(position){
            d("hospital-latitude").value = position.coords.latitude;
            d("hospital-longitude").value = position.coords.latitude;
        }

        // Validate if user is a hospital
        function validate() {
            // Authorised organisations
            // Added edu too for checking purposes
            var auth_orgs = ["org","edu"];
            
            let org_half = d("hospital-email").value.split("@");
            let org = org_half[1].split(".");
            console.log(org);
            // Check for authorised email
            if (auth_orgs.includes(org[1])) {
                console.log(org[1]);
                alert("You are authorized to proceed");
            }
            else{
                // console.log(org[1]);
                alert("You are not authorized to proceed");
            }
        }
    </script>
</body>
</html>